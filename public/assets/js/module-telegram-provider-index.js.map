{"version":3,"sources":["src/module-telegram-provider-index.js"],"names":["idUrl","idForm","className","inputClassName","ModuleTelegramProvider","$formObj","$","$checkBoxes","$dropDowns","saveTableAJAXUrl","globalRootUrl","deleteRecordAJAXUrl","$disabilityFields","$statusToggle","$moduleStatus","authProcess","statusesTimer","eventSource","validateRules","textField","identifier","rules","type","prompt","globalTranslate","mod_tplValidateValueIsEmpty","areaField","passwordField","initialize","window","checkbox","dropdown","addEventListener","checkStatusToggle","initializeForm","tab","el","show","hide","get","result","key","tableName","attr","undefined","initTable","initEventSource","chan","url","location","origin","val","EventSource","withCredentials","onmessage","onPbxMessage","event","statusData","parseJSON","data","e","elDimmer","status","addClass","removeClass","trim","translateStatus","output","text","title","app","phone","modal","closable","onDeny","onApprove","elCommand","command","module_telegram_providerError","checkStatuses","response","haveDisable","id","uriButton","elements","keyElement","elButton","changeStatus","setTimeout","startAuth","failAuth","clearTimeout","console","log","checkStatus","debug","waitingInput","allEnd","each","responseCmd","makeDropdownList","selectType","selected","values","name","value","index","obj","push","changeGroupInList","choice","tdInput","closest","find","currentRowId","replace","sendChangesToServer","options","columns","columnsArray4Sort","colName","DataTable","ajax","ajaxUrl","dataSrc","paging","sDom","deferRender","pageLength","infoCallback","settings","start","end","max","total","pre","language","SemanticLocalization","dataTableLocalisation","ordering","createdRow","row","cols","headers","indexOf","eq","html","uri","DT_RowId","templateDeleteButton","module_telegram_providerCopy","module_telegram_provider_action_remove","bt_ToolTipDelete","template","additionalClass","header","selectMetaData","newTemplate","drawCallback","drowSelectGroup","sTableId","body","on","target","transition","document","keyCode","which","hasClass","endEditInput","preventDefault","elTableName","deleteRow","clipboard","ClipboardJS","error","action","trigger","addNewRow","cbOnDrop","table","priorityWasChanged","priorityData","ruleId","oldPriority","parseInt","newPriority","rowIndex","isNaN","api","method","$el","idTable","remove","Math","floor","random","rowTemplate","before","tableId","selestGroup","onChange","tableDnD","onDrop","onDragClass","dragHandle","substr","onSuccess","length","success","append","recordId","notEmpty","savingRowTable","successTest","Object","keys","rowId","onFailure","message","UserMessage","showMultiString","onError","errorMessage","element","xhr","step3","applyConfigurationChanges","Config","pbxUrl","cbBeforeSendForm","form","cbAfterSendForm","Form","module_telegram_providerNotAllConnected","module_telegram_providerConnected","module_telegram_providerDisconnected","module_telegram_providerUpdateStatus","ready"],"mappings":"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","sourcesContent":["/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 11 2018\n *\n */\nconst idUrl     = 'module-telegram-provider';\nconst idForm    = 'module-telegram-provider-form';\nconst className = 'ModuleTelegramProvider';\nconst inputClassName = 'mikopbx-module-input';\n\n/* global globalRootUrl, globalTranslate, Form, Config, $ */\nconst ModuleTelegramProvider = {\n\t$formObj: $('#'+idForm),\n\t$checkBoxes: $('#'+idForm+' .ui.checkbox'),\n\t$dropDowns: $('#'+idForm+' .ui.dropdown'),\n\tsaveTableAJAXUrl: globalRootUrl + idUrl + \"/saveTableData\",\n\tdeleteRecordAJAXUrl: globalRootUrl + idUrl + \"/delete\",\n\t$disabilityFields: $('#'+idForm+'  .disability'),\n\t$statusToggle: $('#module-status-toggle'),\n\t$moduleStatus: $('#status'),\n\tauthProcess: '',\n\tstatusesTimer: null,\n\teventSource: {},\n\t/**\n\t * Field validation rules\n\t * https://semantic-ui.com/behaviors/form.html\n\t */\n\tvalidateRules: {\n\t\ttextField: {\n\t\t\tidentifier: 'text_field',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'empty',\n\t\t\t\t\tprompt: globalTranslate.mod_tplValidateValueIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tareaField: {\n\t\t\tidentifier: 'text_area_field',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'empty',\n\t\t\t\t\tprompt: globalTranslate.mod_tplValidateValueIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tpasswordField: {\n\t\t\tidentifier: 'password_field',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'empty',\n\t\t\t\t\tprompt: globalTranslate.mod_tplValidateValueIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t},\n\t/**\n\t * On page load we init some Semantic UI library\n\t */\n\tinitialize() {\n\t\t// инициализируем чекбоксы и выподающие менюшки\n\t\twindow[className].$checkBoxes.checkbox();\n\t\twindow[className].$dropDowns.dropdown();\n\t\twindow.addEventListener('ModuleStatusChanged', window[className].checkStatusToggle);\n\t\twindow[className].initializeForm();\n\t\t$('.menu .item').tab({\n\t\t\t'onVisible': (tab) => {\n\t\t\t\tlet el = $(\"#step3\");\n\t\t\t\tif(tab === 'first'){\n\t\t\t\t\tel.show();\n\t\t\t\t}else{\n\t\t\t\t\tel.hide();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t$.get( idUrl + '/getTablesDescription', function( result ) {\n\t\t\tfor (let key in result['data']) {\n\t\t\t\tlet tableName = key + '-table';\n\t\t\t\tif( $('#'+tableName).attr('id') === undefined){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\twindow[className].initTable(tableName, result['data'][key]);\n\t\t\t}\n\t\t});\n\t\twindow[className].checkStatusToggle();\n\t\twindow[className].initEventSource('telegram-provider')\n\t},\n\n\tinitEventSource: function (chan) {\n\t\tlet url = `${window.location.origin}/pbxcore/api/nchan/sub/${chan}?token=${$('#api_hash').val()}`;\n\t\twindow[className].eventSource[chan] = new EventSource(url, {\n\t\t\twithCredentials: true\n\t\t});\n\t\twindow[className].eventSource[chan].onmessage = window[className].onPbxMessage;\n\t\t// window[className].eventSource[chan].onerror   = window[className].onPbxMessageError;\n\t},\n\tonPbxMessage: function(event) {\n\t\tlet statusData;\n\t\ttry{\n\t\t\tstatusData = $.parseJSON(event.data);\n\t\t}catch (e) {\n\t\t\treturn;\n\t\t}\n\t\tlet elDimmer = $('#dimmer-wait-status');\n\t\tif(statusData.status === 'Done'){\n\t\t\t//\n\t\t}else if(statusData.status === 'START_AUTH'){\n\t\t\telDimmer.addClass('active');\n\t\t}else if(statusData.status === 'END_AUTH'){\n\t\t\telDimmer.removeClass('active');\n\t\t}else if(statusData.status === 'WaitInput' && statusData.data.trim() === ''){\n\t\t\tlet translateStatus = globalTranslate[statusData.output];\n\t\t\tif(translateStatus === undefined){\n\t\t\t\ttranslateStatus = statusData.output;\n\t\t\t}\n\t\t\t$('#command-dialog form div.field label').text(translateStatus);\n\t\t\t$('input[id=command]').val('');\n\t\t\tlet title = globalTranslate[\"module_telegram_provider_\" + statusData.app] + ` (${statusData.phone})`;\n\t\t\t$('#command-dialog a.ui.ribbon.label').text(title);\n\t\t\t$('#command-dialog')\n\t\t\t\t.modal({\n\t\t\t\t\tclosable  : false,\n\t\t\t\t\tonDeny    : function(){\n\t\t\t\t\t\t$.get( '/pbxcore/api/modules/'+className+'/cancel-auth?login='+statusData.phone);\n\t\t\t\t\t},\n\t\t\t\t\tonApprove : function() {\n\t\t\t\t\t\tlet elCommand = $('#command');\n\t\t\t\t\t\tlet command = elCommand.val();\n\t\t\t\t\t\telCommand.val('');\n\t\t\t\t\t\t$.get( '/pbxcore/api/modules/'+className+'/enter-command?login='+statusData.phone+'&command='+command+'&key='+statusData.app);\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\t.modal('show');\n\t\t}else if(statusData.status === 'Error'){\n\t\t\t$(\"#error-message\").show();\n\t\t\t$(\"#error-message .header\").text(globalTranslate.module_telegram_providerError);\n\t\t\t$(\"#error-message .body\").text(statusData.output);\n\t\t}\n\t},\n\t/*\n\tПроверка статусов линий\n\t */\n\tcheckStatuses(){\n        $.get( '/pbxcore/api/modules/'+className+'/statuses', function( response ) {\n\t\t\tlet haveDisable = false;\n\t\t\tfor (let id in response.data) {\n\t\t\t\tlet uriButton \t\t= $('#'+className+'-table tr[id='+id+'] button.ui.button');\n\t\t\t\tlet elements = {\n\t\t\t\t\t'gw': $('#'+className+'-table tr[id='+id+'] a[data-name=\"login-gw\"] i'),\n\t\t\t\t\t'user': $('#'+className+'-table tr[id='+id+'] a[data-name=\"login-user\"] i'),\n\t\t\t\t\t'bot': $('#'+className+'-table tr[id='+id+'] a[data-name=\"login-bot\"] i')\n\t\t\t\t};\n\t\t\t\tfor (let keyElement in elements) {\n\t\t\t\t\tlet elButton  = elements[keyElement];\n\t\t\t\t\t$('#'+className+'-table tr[id='+id+'] a[data-name=\"login-'+keyElement+'\"]').attr('data-tooltip', globalTranslate['module_telegram_provider_status_'+keyElement+'_'+response['data'][id][keyElement] ]);\n\t\t\t\t\tif(response['data'][id][keyElement] === 'OK') {\n\t\t\t\t\t\telButton.removeClass('red orange');\n\t\t\t\t\t\telButton.addClass('green');\n\t\t\t\t\t\tif (keyElement === 'gw') {\n\t\t\t\t\t\t\turiButton.show();\n\t\t\t\t\t\t}\n\t\t\t\t\t}else if(response['data'][id][keyElement] === 'WAIT_START'){\n\t\t\t\t\t\telButton.removeClass('green red');\n\t\t\t\t\t\telButton.addClass('orange');\n\t\t\t\t\t\tif(keyElement==='gw'){\n\t\t\t\t\t\t\thaveDisable = true;\n\t\t\t\t\t\t\turiButton.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\telButton.removeClass('green orange');\n\t\t\t\t\t\telButton.addClass('red');\n\t\t\t\t\t\tif(keyElement==='gw'){\n\t\t\t\t\t\t\thaveDisable = true;\n\t\t\t\t\t\t\turiButton.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n            }\n\t\t\tif(haveDisable === true){\n\t\t\t\twindow[className].changeStatus('NotAllConnected');\n\t\t\t}else{\n\t\t\t\twindow[className].changeStatus('Connected');\n\t\t\t}\n\n\t\t\tif(window[className].statusesTimer !== 0){\n\t\t\t\twindow[className].statusesTimer = null;\n\t\t\t\tsetTimeout(window[className].checkStatusToggle, 10000);\n\t\t\t}\n        });\n    },\n\n\t/**\n\t * Запуск процесса авторизации.\n\t * @param id\n\t * @param failAuth\n\t */\n\tstartAuth(id, failAuth) {\n\t\tif(window[className].statusesTimer !== null){\n\t\t\t// Останавливаем проверку статусов.\n\t\t\tclearTimeout(window[className].statusesTimer);\n\t\t\twindow[className].statusesTimer = 0;\n\t\t}\n\t\t$(\"#error-message\").hide();\n\t\t$.get( '/pbxcore/api/modules/'+className+'/start-auth?id='+id+'&type='+window[className].authProcess, function( response ) {\n\t\t\tif(response.result === false){\n\t\t\t\tconsole.log(response);\n\t\t\t\t$(\"#error-message\").show();\n\t\t\t\t$(\"#error-message .header\").text(globalTranslate.module_telegram_providerError);\n\t\t\t\t$(\"#error-message .body\").text('');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// window[className].checkStatus(id);\n\t\t});\n\t},\n\n\t/**\n\t * Запрос статуса авторизации.\n\t * @param id\n\t */\n\tcheckStatus(id) {\n\t\tif(window[className].authProcess === ''){\n\t\t\treturn;\n\t\t}\n\t\tlet elDimmer = $('#dimmer-wait-status');\n\t\telDimmer.addClass('active');\n\t\t$.get( '/pbxcore/api/modules/'+className+'/status?id='+id, function( response ) {\n\t\t\tconsole.debug(response);\n\t\t\tif(window[className].waitingInput === true){\n\t\t\t\t// Зупущено модальное окно ожидания ввода кода доступа.\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(response.result === false){\n\t\t\t\tsetTimeout(window[className].checkStatus, 5000, id);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet allEnd = true;\n\t\t\t$.each(response.data , function(authProcess, statusData) {\n\t\t\t\tif(statusData.status === 'Done'){\n\t\t\t\t\t//\n\t\t\t\t}else if(statusData.status === 'WaitInput' && statusData.data.trim() === ''){\n\t\t\t\t\tallEnd = false;\n\t\t\t\t\tlet translateStatus = globalTranslate[statusData.output];\n\t\t\t\t\tif(translateStatus === undefined){\n\t\t\t\t\t\ttranslateStatus = statusData.output;\n\t\t\t\t\t}\n\t\t\t\t\t$('#command-dialog form div.field label').text(translateStatus);\n\t\t\t\t\t$('input[id=command]').val('');\n\t\t\t\t\tlet phone = $('#ModuleTelegramProvider-table tr[id='+id+'] input[colname=\"phone_number\"]').val();\n\t\t\t\t\tlet title = globalTranslate[\"module_telegram_provider_\" + window[className].authProcess] + ` (${phone})`;\n\t\t\t\t\t$('#command-dialog a.ui.ribbon.label').text(title);\n\t\t\t\t\twindow[className].waitingInput = true;\n\t\t\t\t\t$('#command-dialog')\n\t\t\t\t\t\t.modal({\n\t\t\t\t\t\t\tclosable  : false,\n\t\t\t\t\t\t\tonDeny    : function(){\n\t\t\t\t\t\t\t\t$.get( '/pbxcore/api/modules/'+className+'/cancel-auth?id='+id);\n\t\t\t\t\t\t\t\twindow[className].waitingInput = false;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonApprove : function() {\n\t\t\t\t\t\t\t\tlet elCommand = $('#command');\n\t\t\t\t\t\t\t\tlet command = elCommand.val();\n\t\t\t\t\t\t\t\telCommand.val('');\n\t\t\t\t\t\t\t\t$.get( '/pbxcore/api/modules/'+className+'/enter-command?id='+id+'&command='+command+'&key='+authProcess, function( responseCmd ) {\n\t\t\t\t\t\t\t\t\tif(responseCmd.result === true){\n\t\t\t\t\t\t\t\t\t\tsetTimeout(window[className].checkStatus, 3000, id);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\twindow[className].waitingInput = false;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.modal('show');\n\t\t\t\t}else if(statusData.status === 'Error'){\n\t\t\t\t\t$(\"#error-message\").show();\n\t\t\t\t\t$(\"#error-message .header\").text(globalTranslate.module_telegram_providerError);\n\t\t\t\t\t$(\"#error-message .body\").text(statusData.output);\n\t\t\t\t}else{\n\t\t\t\t\tallEnd = false;\n\t\t\t\t\tsetTimeout(window[className].checkStatus, 2000, id);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif(allEnd === true){\n\t\t\t\twindow[className].authProcess = '';\n\t\t\t\telDimmer.removeClass('active');\n\t\t\t\twindow[className].statusesTimer = null;\n\t\t\t\t// Возобновляем проверку статусов линий.\n\t\t\t\twindow[className].checkStatusToggle();\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t *\n\t * @param selectType\n\t * @param selected\n\t * @returns {[{name: string, value: string, selected: boolean}]}\n\t */\n\tmakeDropdownList(selectType, selected) {\n\t\tconst values = [\n\t\t\t{\n\t\t\t\tname: ' --- ',\n\t\t\t\tvalue: '',\n\t\t\t\tselected: ('' === selected),\n\t\t\t}\n\t\t];\n\t\t$('#'+selectType+' option').each((index, obj) => {\n\t\t\tvalues.push({\n\t\t\t\tname: obj.text,\n\t\t\t\tvalue: obj.value,\n\t\t\t\tselected: (selected === obj.value),\n\t\t\t});\n\t\t});\n\t\treturn values;\n\t},\n\t/**\n\t * Обработка изменения группы в списке\n\t */\n\tchangeGroupInList(value, text, choice) {\n\t\tlet tdInput = $(choice).closest('td').find('input');\n\t\ttdInput.attr('data-value', \tvalue);\n\t\ttdInput.attr('value', \t\tvalue);\n\t\tlet currentRowId = $(choice).closest('tr').attr('id');\n\t\tlet tableName    = $(choice).closest('table').attr('id').replace('-table', '');\n\t\tif (currentRowId !== undefined && tableName !== undefined) {\n\t\t\twindow[className].sendChangesToServer(tableName, currentRowId);\n\t\t}\n\t},\n\n\t/**\n\t * Add new Table.\n\t */\n\tinitTable(tableName, options) {\n\t\tlet columns = [];\n\t\tlet columnsArray4Sort = []\n\t\tfor (let colName in options['cols']) {\n\t\t\tcolumns.push( {data: colName});\n\t\t\tcolumnsArray4Sort.push(colName);\n\t\t}\n\t\t$('#' + tableName).DataTable( {\n\t\t\tajax: {\n\t\t\t\turl: idUrl + options.ajaxUrl + '?table=' +tableName.replace('-table', ''),\n\t\t\t\tdataSrc: 'data'\n\t\t\t},\n\t\t\tcolumns: columns,\n\t\t\tpaging: false,\n\t\t\tsDom: 'rtip',\n\t\t\tdeferRender: true,\n\t\t\tpageLength: 17,\n\t\t\tinfoCallback( settings, start, end, max, total, pre ) {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t\tlanguage: SemanticLocalization.dataTableLocalisation,\n\t\t\tordering: false,\n\t\t\t/**\n\t\t\t * Builder row presentation\n\t\t\t * @param row\n\t\t\t * @param data\n\t\t\t */\n\t\t\tcreatedRow(row, data) {\n\t\t\t\tlet cols    = $('td', row);\n\t\t\t\tlet headers = $('#'+ tableName + ' thead tr th');\n\t\t\t\tfor (let key in data) {\n\t\t\t\t\tlet index = columnsArray4Sort.indexOf(key);\n\t\t\t\t\tif(key === 'rowIcon'){\n\t\t\t\t\t\tcols.eq(index).html('<i class=\"ui ' + data[key] + ' circle icon\"></i>');\n\t\t\t\t\t}else if(key === 'delButton'){\n\t\t\t\t\t\tlet uri = '127.0.0.1:'+(30000+1*data.DT_RowId);\n\t\t\t\t\t\tlet templateDeleteButton = '<div class=\"ui small basic icon buttons action-buttons\">' +\n\t\t\t\t\t\t\t'<button data-name=\"uri-button\" class=\"ui button clipboard disability\" data-tooltip=\"'+globalTranslate.module_telegram_providerCopy+'\"  data-position=\"left center\" data-clipboard-text=\"'+uri+'\" style=\"display: none;\">sip:'+uri+'</button>'+\n\t\t\t\t\t\t\t'<a data-name=\"login-gw\"  href=\"\" class=\"ui button popuped\"><i class=\"icon telegram\"></i></a>'+\n\t\t\t\t\t\t\t'<a data-name=\"login-user\"  href=\"\" class=\"ui button popuped\"><i class=\"icon envelope\"></i></a>'+\n\t\t\t\t\t\t\t'<a data-name=\"login-bot\"  href=\"\" class=\"ui button popuped\"><i class=\"icon android secret\"></i></a>'+\n\t\t\t\t\t\t\t'<a data-name=\"delete-button\" href=\"' + window[className].deleteRecordAJAXUrl + '/' +\n\t\t\t\t\t\t\tdata.DT_RowId + '\" data-value = \"' + data.DT_RowId + '\"' +\n\t\t\t\t\t\t\t' class=\"ui button delete two-steps-delete popuped\" data-tooltip=\"'+globalTranslate.module_telegram_provider_action_remove+'\" data-content=\"' + globalTranslate.bt_ToolTipDelete + '\">' +\n\t\t\t\t\t\t\t'<i class=\"icon trash red\"></i></a></div>';\n\t\t\t\t\t\tcols.eq(index).html(templateDeleteButton);\n\t\t\t\t\t\tcols.eq(index).addClass('right aligned');\n\t\t\t\t\t}else if(key === 'priority'){\n\t\t\t\t\t\tcols.eq(index).addClass('dragHandle')\n\t\t\t\t\t\tcols.eq(index).html('<i class=\"ui sort circle icon\"></i>');\n\t\t\t\t\t\t// Приоритет устанавливаем для строки.\n\t\t\t\t\t\t$(row).attr('m-priority', data[key]);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tlet template = '<div class=\"ui transparent fluid input inline-edit\">' +\n\t\t\t\t\t\t\t'<input colName=\"'+key+'\" class=\"'+inputClassName+'\" type=\"text\" data-value=\"'+data[key] + '\" value=\"' + data[key] + '\"></div>';\n\t\t\t\t\t\t$('td', row).eq(index).html(template);\n\t\t\t\t\t}\n\t\t\t\t\tif(options['cols'][key] === undefined){\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tlet additionalClass = options['cols'][key]['class'];\n\t\t\t\t\tif(additionalClass !== undefined && additionalClass !== ''){\n\t\t\t\t\t\theaders.eq(index).addClass(additionalClass);\n\t\t\t\t\t}\n\t\t\t\t\tlet header = options['cols'][key]['header'];\n\t\t\t\t\tif(header !== undefined && header !== ''){\n\t\t\t\t\t\theaders.eq(index).html(header);\n\t\t\t\t\t}\n\n\t\t\t\t\tlet selectMetaData = options['cols'][key]['select'];\n\t\t\t\t\tif(selectMetaData !== undefined){\n\t\t\t\t\t\tlet newTemplate = $('#template-select').html().replace('PARAM', data[key]);\n\t\t\t\t\t\tlet template = '<input class=\"'+inputClassName+'\" colName=\"'+key+'\" selectType=\"'+selectMetaData+'\" style=\"display: none;\" type=\"text\" data-value=\"'+data[key] + '\" value=\"' + data[key] + '\"></div>';\n\t\t\t\t\t\tcols.eq(index).html(newTemplate + template);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * Draw event - fired once the table has completed a draw.\n\t\t\t */\n\t\t\tdrawCallback(settings) {\n\t\t\t\twindow[className].drowSelectGroup(settings.sTableId);\n\t\t\t},\n\t\t} );\n\n\t\tlet body = $('body');\n\t\t// Клик по полю. Вход для редактирования значения.\n\t\tbody.on('focusin', '.'+inputClassName, function (e) {\n\t\t\t$(e.target).transition('glow');\n\t\t\t$(e.target).closest('div').removeClass('transparent').addClass('changed-field');\n\t\t\t$(e.target).attr('readonly', false);\n\t\t})\n\t\t// Отправка формы на сервер по Enter или Tab\n\t\t$(document).on('keydown', function (e) {\n\t\t\tlet keyCode = e.keyCode || e.which;\n\t\t\tif (keyCode === 13 || keyCode === 9 && $(':focus').hasClass('mikopbx-module-input')) {\n\t\t\t\twindow[className].endEditInput();\n\t\t\t}\n\t\t});\n\n\t\tbody.on('click', 'a[data-name=\"login-gw\"]', function (e) {\n\t\t\te.preventDefault();\n\t\t\twindow[className].authProcess = 'gw';\n\t\t\tlet currentRowId = $(e.target).closest('tr').attr('id');\n\t\t\twindow[className].startAuth(currentRowId);\n\t\t});\t\t\n\t\tbody.on('click', 'a[data-name=\"login-user\"]', function (e) {\n\t\t\te.preventDefault();\n\t\t\twindow[className].authProcess = 'user';\n\t\t\tlet currentRowId = $(e.target).closest('tr').attr('id');\n\t\t\twindow[className].startAuth(currentRowId);\n\t\t});\n\t\tbody.on('click', 'a[data-name=\"login-bot\"]', function (e) {\n\t\t\te.preventDefault();\n\t\t\twindow[className].authProcess = 'bot';\n\t\t\tlet currentRowId = $(e.target).closest('tr').attr('id');\n\t\t\twindow[className].startAuth(currentRowId);\n\t\t});\n\t\tbody.on('click', 'button[data-name=\"uri-button\"]', function (e) {\n\t\t\te.preventDefault();\n\t\t});\n\t\tbody.on('click', 'a.delete', function (e) {\n\t\t\te.preventDefault();\n\t\t\tlet currentRowId = $(e.target).closest('tr').attr('id');\n\t\t\tlet elTableName    = $(e.target).closest('table').attr('id').replace('-table', '');\n\t\t\twindow[className].deleteRow(elTableName, currentRowId);\n\t\t}); // Добавление новой строки\n\n\t\tlet clipboard = new ClipboardJS('.clipboard');\n\t\tclipboard.on('error', function (e) {\n\t\t\tconsole.error('Action:', e.action);\n\t\t\tconsole.error('Trigger:', e.trigger);\n\t\t});\n\t\t// Отправка формы на сервер по уходу с поля ввода\n\t\tbody.on('focusout', '.'+inputClassName, window[className].endEditInput);\n\n\t\t// Кнопка \"Добавить новую запись\"\n\t\t$('[id-table = \"'+tableName+'\"]').on('click', window[className].addNewRow);\n\t},\n\n\t/**\n\t * Перемещение строки, изменение приоритета.\n\t */\n\tcbOnDrop(table, row) {\n\t\tlet priorityWasChanged = false;\n\t\tconst priorityData = {};\n\t\t$(table).find('tr').each((index, obj) => {\n\t\t\tconst ruleId = $(obj).attr('id');\n\t\t\tconst oldPriority = parseInt($(obj).attr('m-priority'), 10);\n\t\t\tconst newPriority = obj.rowIndex;\n\t\t\tif (!isNaN( ruleId ) && oldPriority !== newPriority) {\n\t\t\t\tpriorityWasChanged = true;\n\t\t\t\tpriorityData[ruleId] = newPriority;\n\t\t\t}\n\t\t});\n\t\tif (priorityWasChanged) {\n\t\t\t$.api({\n\t\t\t\ton: 'now',\n\t\t\t\turl: `${globalRootUrl}${idUrl}/changePriority?table=`+$(table).attr('id').replace('-table', ''),\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata: priorityData,\n\t\t\t});\n\t\t}\n\t},\n\n\t/**\n\t * Окончание редактирования поля ввода.\n\t * Не относится к select.\n\t * @param e\n\t */\n\tendEditInput(e){\n\t\tlet $el = $('.changed-field').closest('tr');\n\t\t$el.each(function (index, obj) {\n\t\t\tlet currentRowId = $(obj).attr('id');\n\t\t\tlet tableName    = $(obj).closest('table').attr('id').replace('-table', '');\n\t\t\tif (currentRowId !== undefined && tableName !== undefined) {\n\t\t\t\twindow[className].sendChangesToServer(tableName, currentRowId);\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Добавление новой строки в таблицу.\n\t * @param e\n\t */\n\taddNewRow(e){\n\t\tlet idTable = $(e.target).attr('id-table');\n\t\tlet table   = $('#'+idTable);\n\t\te.preventDefault();\n\t\ttable.find('.dataTables_empty').remove();\n\t\t// Отправим на запись все что не записано еще\n\t\tlet $el = table.find('.changed-field').closest('tr');\n\t\t$el.each(function (index, obj) {\n\t\t\tlet currentRowId = $(obj).attr('id');\n\t\t\tif (currentRowId !== undefined) {\n\t\t\t\twindow[className].sendChangesToServer(currentRowId);\n\t\t\t}\n\t\t});\n\t\tlet id = \"new\"+Math.floor(Math.random() * Math.floor(500));\n\t\tlet rowTemplate = '<tr id=\"'+id+'\" role=\"row\" class=\"even\">'+table.find('tr#TEMPLATE').html().replace('TEMPLATE', id)+'</tr>';\n\t\ttable.find('tbody > tr:first').before(rowTemplate);\n\t\twindow[className].drowSelectGroup(idTable);\n\t},\n\t/**\n\t * Обновление select элементов.\n\t * @param tableId\n\t */\n\tdrowSelectGroup(tableId) {\n\t\t$('#' + tableId).find('tr#TEMPLATE').hide();\n\t\tlet selestGroup = $('.select-group');\n\t\tselestGroup.each((index, obj) => {\n\t\t\tlet selectType = $(obj).closest('td').find('input').attr('selectType');\n\t\t\t$(obj).dropdown({\n\t\t\t\tvalues: window[className].makeDropdownList(selectType, $(obj).attr('data-value')),\n\t\t\t});\n\t\t});\n\t\tselestGroup.dropdown({\n\t\t\tonChange: window[className].changeGroupInList,\n\t\t});\n\n\t\t$('#' + tableId).tableDnD({\n\t\t\tonDrop: window[className].cbOnDrop,\n\t\t\tonDragClass: 'hoveringRow',\n\t\t\tdragHandle: '.dragHandle',\n\t\t});\n\t},\n\t/**\n\t * Удаление строки\n\t * @param tableName\n\t * @param id - record id\n\t */\n\tdeleteRow(tableName, id) {\n\t\tlet table = $('#'+ tableName+'-table');\n\t\tif (id.substr(0,3) === 'new') {\n\t\t\ttable.find('tr#'+id).remove();\n\t\t\treturn;\n\t\t}\n\t\t$.api({\n\t\t\turl: window[className].deleteRecordAJAXUrl+'?id='+id+'&table='+tableName,\n\t\t\ton: 'now',\n\t\t\tonSuccess(response) {\n\t\t\t\tif(tableName === 'ModuleTelegramProvider' && $('#'+ tableName+'-table tbody tr').length === 2){\n\t\t\t\t\t$('#'+ tableName+'-table tbody tr[id='+id+'] input[colname=\"phone_number\"]').val('');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (response.success) {\n\t\t\t\t\ttable.find('tr#'+id).remove();\n\t\t\t\t\tif (table.find('tbody > tr').length === 0) {\n\t\t\t\t\t\ttable.find('tbody').append('<tr class=\"odd\"></tr>');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tif(tableName === 'ModuleTelegramProvider'){\n\t\t\tlet phone = $(\"#\"+ tableName+\"-table tr[id=\"+id+\"] input[colname=phone_number]\").val();\n\t\t\t$.get( '/pbxcore/api/modules/'+className+'/logout?id='+id+'&phone='+phone);\n\t\t}\n\t},\n\n\t/**\n\t * Отправка данных на сервер при измении\n\t * @param tableName\n\t * @param recordId\n\t * @returns {boolean}\n\t */\n\tsendChangesToServer(tableName, recordId) {\n\t\tlet data = { 'pbx-table-id': tableName, 'pbx-row-id':  recordId};\n\t\tlet notEmpty = false;\n\t\t$(\"tr#\"+recordId + ' .' + inputClassName).each(function (index, obj) {\n\t\t\tlet colName = $(obj).attr('colName');\n\t\t\tif(colName !== undefined){\n\t\t\t\tdata[$(obj).attr('colName')] = $(obj).val();\n\t\t\t\tif($(obj).val() !== ''){\n\t\t\t\t\tnotEmpty = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tif(notEmpty === false){\n\t\t\treturn;\n\t\t}\n\t\t$(\"tr#\"+recordId+\" .user.circle\").removeClass('user circle').addClass('spinner loading');\n\t\tif(window[className].savingRowTable === true){\n\t\t\t// Уже идет другое сохранение.\n\t\t\treturn;\n\t\t}\n\t\twindow[className].savingRowTable = true;\n\t\t$.api({\n\t\t\turl: window[className].saveTableAJAXUrl,\n\t\t\ton: 'now',\n\t\t\tmethod: 'POST',\n\t\t\tdata: data,\n\t\t\tsuccessTest(response) {\n\t\t\t\treturn response !== undefined && Object.keys(response).length > 0 && response.success === true;\n\t\t\t},\n\t\t\tonSuccess(response) {\n\t\t\t\twindow[className].savingRowTable = false;\n\t\t\t\tif (response.data !== undefined) {\n\t\t\t\t\tlet rowId = response.data['pbx-row-id'];\n\t\t\t\t\tlet table = $('#'+response.data['pbx-table-id']+'-table');\n\t\t\t\t\ttable.find(\"tr#\" + rowId + \" input\").attr('readonly', true);\n\t\t\t\t\ttable.find(\"tr#\" + rowId + \" div\").removeClass('changed-field loading').addClass('transparent');\n\t\t\t\t\ttable.find(\"tr#\" + rowId + \" .spinner.loading\").addClass('user circle').removeClass('spinner loading');\n\n\t\t\t\t\tif (rowId !== response.data['newId']){\n\t\t\t\t\t\t$(`tr#${rowId}`).attr('id', response.data['newId']);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tonFailure(response) {\n\t\t\t\twindow[className].savingRowTable = false;\n\t\t\t\tif (response.message !== undefined) {\n\t\t\t\t\tUserMessage.showMultiString(response.message);\n\t\t\t\t}\n\t\t\t\t$(\"tr#\" + recordId + \" .spinner.loading\").addClass('user circle').removeClass('spinner loading');\n\t\t\t},\n\t\t\tonError(errorMessage, element, xhr) {\n\t\t\t\twindow[className].savingRowTable = false;\n\t\t\t\tif (xhr.status === 403) {\n\t\t\t\t\twindow.location = globalRootUrl + \"session/index\";\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t/**\n\t * Change some form elements classes depends of module status\n\t */\n\tcheckStatusToggle() {\n\t\tlet step3 = $(\"#step3\");\n\t\tif (window[className].$statusToggle.checkbox('is checked')) {\n\t\t\twindow[className].$disabilityFields.removeClass('disabled');\n\t\t\tstep3.removeClass('disabled');\n\t\t\twindow[className].$moduleStatus.show();\n\t\t\tif(window[className].statusesTimer === null){\n\t\t\t\twindow[className].statusesTimer=1;\n\t\t\t\twindow[className].checkStatuses();\n\t\t\t}\n\t\t} else {\n\t\t\twindow[className].$disabilityFields.addClass('disabled');\n\t\t\tstep3.addClass('disabled');\n\t\t\twindow[className].$moduleStatus.hide();\n\t\t}\n\t},\n\t/**\n\t * Send command to restart module workers after data changes,\n\t * Also we can do it on TemplateConf->modelsEventChangeData method\n\t */\n\tapplyConfigurationChanges() {\n\t\twindow[className].changeStatus('Updating');\n\t\t$.api({\n\t\t\turl: `${Config.pbxUrl}/pbxcore/api/modules/`+className+`/reload`,\n\t\t\ton: 'now',\n\t\t\tsuccessTest(response) {\n\t\t\t\t// test whether a JSON response is valid\n\t\t\t\treturn Object.keys(response).length > 0 && response.result === true;\n\t\t\t},\n\t\t\tonSuccess() {\n\t\t\t\twindow[className].changeStatus('Connected');\n\t\t\t},\n\t\t\tonFailure() {\n\t\t\t\twindow[className].changeStatus('Disconnected');\n\t\t\t},\n\t\t});\n\t},\n\t/**\n\t * We can modify some data before form send\n\t * @param settings\n\t * @returns {*}\n\t */\n\tcbBeforeSendForm(settings) {\n\t\tconst result = settings;\n\t\tresult.data = window[className].$formObj.form('get values');\n\t\treturn result;\n\t},\n\t/**\n\t * Some actions after forms send\n\t */\n\tcbAfterSendForm() {\n\t\twindow[className].applyConfigurationChanges();\n\t},\n\t/**\n\t * Initialize form parameters\n\t */\n\tinitializeForm() {\n\t\tForm.$formObj = window[className].$formObj;\n\t\tForm.url = `${globalRootUrl}${idUrl}/save`;\n\t\tForm.validateRules = window[className].validateRules;\n\t\tForm.cbBeforeSendForm = window[className].cbBeforeSendForm;\n\t\tForm.cbAfterSendForm = window[className].cbAfterSendForm;\n\t\tForm.initialize();\n\t},\n\t/**\n\t * Update the module state on form label\n\t * @param status\n\t */\n\tchangeStatus(status) {\n\t\tswitch (status) {\n\t\t\tcase 'NotAllConnected':\n\t\t\t\twindow[className].$moduleStatus\n\t\t\t\t\t.removeClass('grey')\n\t\t\t\t\t.removeClass('red')\n\t\t\t\t\t.removeClass('green')\n\t\t\t\t\t.addClass('orange');\n\t\t\t\twindow[className].$moduleStatus.html(globalTranslate.module_telegram_providerNotAllConnected);\n\t\t\t\tbreak;\n\t\t\tcase 'Connected':\n\t\t\t\twindow[className].$moduleStatus\n\t\t\t\t\t.removeClass('grey')\n\t\t\t\t\t.removeClass('red')\n\t\t\t\t\t.removeClass('orange')\n\t\t\t\t\t.addClass('green');\n\t\t\t\twindow[className].$moduleStatus.html(globalTranslate.module_telegram_providerConnected);\n\t\t\t\tbreak;\n\t\t\tcase 'Disconnected':\n\t\t\t\twindow[className].$moduleStatus\n\t\t\t\t\t.removeClass('green')\n\t\t\t\t\t.removeClass('red')\n\t\t\t\t\t.removeClass('orange')\n\t\t\t\t\t.addClass('grey');\n\t\t\t\twindow[className].$moduleStatus.html(globalTranslate.module_telegram_providerDisconnected);\n\t\t\t\tbreak;\n\t\t\tcase 'Updating':\n\t\t\t\twindow[className].$moduleStatus\n\t\t\t\t\t.removeClass('green')\n\t\t\t\t\t.removeClass('red')\n\t\t\t\t\t.removeClass('orange')\n\t\t\t\t\t.addClass('grey');\n\t\t\t\twindow[className].$moduleStatus.html(`<i class=\"spinner loading icon\"></i>${globalTranslate.module_telegram_providerUpdateStatus}`);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\twindow[className].$moduleStatus\n\t\t\t\t\t.removeClass('green')\n\t\t\t\t\t.removeClass('red')\n\t\t\t\t\t.removeClass('orange')\n\t\t\t\t\t.addClass('grey');\n\t\t\t\twindow[className].$moduleStatus.html(globalTranslate.module_telegram_providerDisconnected);\n\t\t\t\tbreak;\n\t\t}\n\t},\n};\n\n$(document).ready(() => {\n\twindow[className].initialize();\n});\n\n"],"file":"module-telegram-provider-index.js"}